---
 // @ts-ignore
 import logoSrc from "../assets/logo.png?format=webp&w=64&h=64";
---

<header class="bg-linear-to-r from-background-10 to-background-50 text-text shadow-lg">
  <div class="max-w-6xl mx-auto flex justify-between items-center p-(--space-4)">
    <!-- Logo -->
    <a href="/" class="flex items-center gap-2 text-lg font-bold font-minecraft">
      <img src={logoSrc} alt="Logo" class="h-[2em] w-auto" />
      BaggelMC
    </a>

    <!-- Desktop Navigation -->
    <nav class="hidden md:block">
      <ul class="flex space-x-6 items-center relative">
        <li><a href="/" class="hover:text-accent transition">Home</a></li>

        <!-- Projects Dropdown -->
        <li class="dropdown relative group">
          <button class="hover:text-accent transition flex items-center gap-1">
            Projekte
            <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" fill="none" viewBox="0 0 24 24" stroke="currentColor">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7" />
            </svg>
          </button>
          <ul class="dropdown-menu z-9999 absolute left-0 mt-2 rounded-2xl opacity-0 -translate-y-2 pointer-events-none transition-all duration-200 ease-in-out
            p-px bg-linear-to-br from-background via-background-50 to-background group-hover:opacity-100 group-hover:translate-y-0 group-hover:pointer-events-auto">
            <div class="bg-background rounded-[inherit]">
              <li><a href="/projects/baggel" class="block px-4 py-2 hover:bg-accent-light hover:text-accent transition">Baggel.de</a></li>
              <li><a href="/projects/buildmc" class="block px-4 py-2 hover:bg-accent-light hover:text-accent transition">BuildMC</a></li>
              <li><a href="/projects/nations" class="block px-4 py-2 hover:bg-accent-light hover:text-accent transition">Nations</a></li>
            </div>
          </ul>
        </li>

        <!-- Plugins Dropdown -->
        <li class="dropdown relative group">
          <button class="hover:text-accent transition flex items-center gap-1">
            Plugins
            <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" fill="none" viewBox="0 0 24 24" stroke="currentColor">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7" />
            </svg>
          </button>
          <ul class="dropdown-menu absolute left-0 mt-2 rounded-2xl opacity-0 -translate-y-2 pointer-events-none transition-all duration-200 ease-in-out
            p-px bg-linear-to-br from-background via-background-50 to-background group-hover:opacity-100 group-hover:translate-y-0 group-hover:pointer-events-auto">
            <div class="bg-background rounded-[inherit]">
              <li><a href="/plugins/en/core" class="block px-4 py-2 hover:bg-accent-light hover:text-accent transition">Core</a></li>
            </div>
          </ul>
        </li>

        <!-- Static Pages -->
        <li><a href="/gallery" class="hover:text-accent transition">Gallerie</a></li>
        <li><a href="/team" class="hover:text-accent transition">Team</a></li>
      </ul>
    </nav>

    <!-- Mobile Menu Button -->
    <button id="mobile-menu-toggle" class="md:hidden flex flex-col gap-1 p-2 hover:text-accent transition">
      <span class="block w-6 h-0.5 bg-current"></span>
      <span class="block w-6 h-0.5 bg-current"></span>
      <span class="block w-6 h-0.5 bg-current"></span>
    </button>
  </div>

  <!-- Mobile Navigation -->
  <nav id="mobile-menu" class="md:hidden max-h-0 overflow-hidden transition-all duration-300 ease-in-out bg-background/95 backdrop-blur-md">
    <ul class="flex flex-col p-4 space-y-2 border-t border-background-50">
      <li><a href="/" class="block py-2 hover:text-accent transition">Home</a></li>

      <!-- Projects -->
      <li>
        <button class="w-full text-left flex justify-between items-center py-2 hover:text-accent transition" data-toggle="projects">
          Projekte
          <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 transform transition-transform" fill="none" viewBox="0 0 24 24" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7" />
          </svg>
        </button>
        <ul class="hidden pl-4 space-y-1" id="projects">
          <li><a href="/projects/baggel" class="block py-1 hover:text-accent">Baggel.de</a></li>
          <li><a href="/projects/buildmc" class="block py-1 hover:text-accent">BuildMC</a></li>
          <li><a href="/projects/nations" class="block py-1 hover:text-accent">Nations</a></li>
        </ul>
      </li>

      <!-- Plugins -->
      <li>
        <button class="w-full text-left flex justify-between items-center py-2 hover:text-accent transition" data-toggle="plugins">
          Plugins
          <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 transform transition-transform" fill="none" viewBox="0 0 24 24" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7" />
          </svg>
        </button>
        <ul class="hidden pl-4 space-y-1" id="plugins">
          <li><a href="/plugins/en/core" class="block py-1 hover:text-accent">Core</a></li>
        </ul>
      </li>

      <!-- Static -->
      <li><a href="/gallery" class="block py-2 hover:text-accent transition">Gallerie</a></li>
      <li><a href="/team" class="block py-2 hover:text-accent transition">Team</a></li>
    </ul>
  </nav>

  <script src="./Header.ts"></script>
  <script>
    const themeToggle = document.getElementById('theme-toggle');
    const themeToggleMobile = document.getElementById('theme-toggle-mobile');
    const root = document.documentElement;

    function toggleTheme() {
      if (root.dataset.theme === 'light') {
        root.removeAttribute('data-theme'); // back to dark
      } else {
        root.dataset.theme = 'light';
      }
    }

    themeToggle?.addEventListener('click', toggleTheme);
    themeToggleMobile?.addEventListener('click', toggleTheme);
  </script>

  <script>
    const dropdowns = document.querySelectorAll<HTMLElement>('.dropdown');

    dropdowns.forEach((dropdown) => {
      const menu = dropdown.querySelector<HTMLElement>('.dropdown-menu');
      if (!menu) return;

      let timeoutId: number | undefined;

      const closeMenu = () => {
        menu.classList.remove('opacity-100', 'translate-y-0');
        menu.classList.add('opacity-0', '-translate-y-2', 'pointer-events-none');
      };

      const openMenu = () => {
        // Close all dropdowns
        dropdowns.forEach((otherDropdown) => {
          if (otherDropdown === dropdown) return;
          const otherMenu = otherDropdown.querySelector<HTMLElement>('.dropdown-menu');
          if (otherMenu) {
            otherMenu.classList.remove('opacity-100', 'translate-y-0');
            otherMenu.classList.add('opacity-0', '-translate-y-2', 'pointer-events-none');
          }
        });

        clearTimeout(timeoutId);
        menu.classList.add('opacity-100', 'translate-y-0');
        menu.classList.remove('opacity-0', '-translate-y-2', 'pointer-events-none');
      };

      dropdown.addEventListener('mouseenter', openMenu);

      dropdown.addEventListener('mouseleave', () => {
        timeoutId = window.setTimeout(() => {
          closeMenu();
        }, 1000); // 1s delay
      });
    });
  </script>
</header>
